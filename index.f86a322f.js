function t(t){document.querySelector("#status").textContent=t}var e=async function e(n){t(`Loading "${n}" article text...`);const a="https://en.wikipedia.org/w/api.php?"+new URLSearchParams({origin:"*",action:"parse",page:n,format:"json",prop:"wikitext"}),o=await fetch(a),r=await o.json();if(!r.parse)return t(`Could not load "${n}"`),null;const i=r.parse.wikitext["*"],l=function(t){const e=/#REDIRECT.+\[\[(.+)]]/.exec(t);return null!==e?e[1]:null}(i);return null!==l?e(l):(t(""),i)};var n=async function(t){if(t in localStorage){const e=localStorage.getItem(t);return""===e?null:e}const e={format:"json",action:"query",titles:t,prop:"langlinks",lllang:"ja",origin:"*"};let n="https://en.wikipedia.org/w/api.php?";Object.keys(e).forEach((function(t){n+="&"+t+"="+e[t]}));const a=await fetch(n),o=await a.json();if(!("query"in o)||!("pages"in o.query))return localStorage.setItem(t,""),null;const r=parseInt(Object.keys(o.query.pages)[0]),i=o.query.pages[r].langlinks;if(!i)return localStorage.setItem(t,""),null;const l=i[0]["*"];return localStorage.setItem(t,l),l};async function a(t){const e={q:t,source:"en",target:"ja",format:"text"},n=await fetch("https://translation.googleapis.com/language/translate/v2?key=AIzaSyAew5zvKW6uGLqj_xVwIXd1ZJdByKHBY9I",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return(await n.json()).data.translations[0].translatedText}async function o(e){let o=e;const r=function(t){return[...new Set([...t.matchAll(/\[\[(.+?)]]/g)].map((t=>t[1]))).keys()].filter((t=>!t.startsWith("File:"))).map((t=>t.split("|"))).filter((t=>t.length<=2))}(e);for(const[e,i]of r){t(`Converting "${e}"...`);const r=await n(e),l=new RegExp(String.raw`\[\[${e}${i?`|${i}`:""}]]`,"g");let c;if(null===r){c=`{{ill|${await a(e)}|en|${e}${i?`|label=${i}`:""}}}`}else c=`[[${r}${i?`|${i}`:""}]]`;o=o.replace(l,c)}return t(""),o}async function r(){const t=document.querySelector("#article-name").value,a=await n(t);document.querySelector("#langlink").value=`${t} => ${a??"not found"}`;const o=await e(t);document.querySelector("#wikitext").value=o??"not found"}async function i(){const t=document.querySelector("#wikitext").value,e=await o(t);document.querySelector("#replaced-wikitext").value=e}document.addEventListener("DOMContentLoaded",(()=>{document.querySelector("#article-name").addEventListener("keydown",(t=>{"Enter"===t.key&&r()}));document.querySelector("button#fetch").addEventListener("click",r);document.querySelector("button#convert").addEventListener("click",i)}));
//# sourceMappingURL=index.f86a322f.js.map
