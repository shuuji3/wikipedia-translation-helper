function e(e){document.querySelector("#status").textContent=e}var t=async function t(n){e(`Loading "${n}" article text...`);const a="https://en.wikipedia.org/w/api.php?"+new URLSearchParams({origin:"*",action:"parse",page:n,format:"json",prop:"wikitext"}),o=await fetch(a),r=await o.json();if(!r.parse)return e(`Could not load "${n}"`),null;const l=r.parse.wikitext["*"],c=function(e){const t=/#REDIRECT.+\[\[(.+)]]/.exec(e);return null!==t?t[1]:null}(l);return null!==c?t(c):(e(""),l)};var n=async function(e){if(e in localStorage){const t=localStorage.getItem(e);return""===t?null:t}const t={format:"json",action:"query",titles:e,prop:"langlinks",lllang:"ja",origin:"*"};let n="https://en.wikipedia.org/w/api.php?";Object.keys(t).forEach((function(e){n+="&"+e+"="+t[e]}));const a=await fetch(n),o=await a.json();if(!("query"in o)||!("pages"in o.query))return localStorage.setItem(e,""),null;const r=parseInt(Object.keys(o.query.pages)[0]),l=o.query.pages[r].langlinks;if(!l)return localStorage.setItem(e,""),null;const c=l[0]["*"];return localStorage.setItem(e,c),c};async function a(t){let a=t;const o=function(e){return[...new Set([...e.matchAll(/\[\[(.+?)]]/g)].map((e=>e[1]))).keys()].filter((e=>!e.startsWith("File:"))).map((e=>e.split("|"))).filter((e=>e.length<=2))}(t);for(const[t,r]of o){e(`Converting "${t}"...`);const o=await n(t),l=new RegExp(String.raw`\[\[${t}${r?`|${r}`:""}]]`,"g");let c;if(null===o){c=`{{ill|${await googleTranslate(t)}|en|${t}${r?`|label=${r}`:""}}}`}else c=`[[${o}${r?`|${r}`:""}]]`;a=a.replace(l,c)}return e(""),a}async function o(){const e=document.querySelector("#article-name").value,a=await n(e);document.querySelector("#langlink").value=`${e} => ${a??"not found"}`;const o=await t(e);document.querySelector("#wikitext").value=o??"not found"}async function r(){const e=document.querySelector("#wikitext").value,t=await a(e);document.querySelector("#replaced-wikitext").value=t}document.addEventListener("DOMContentLoaded",(()=>{document.querySelector("#article-name").addEventListener("keydown",(e=>{"Enter"===e.key&&o()}));document.querySelector("button#fetch").addEventListener("click",o);document.querySelector("button#convert").addEventListener("click",r)}));
//# sourceMappingURL=index.ff442889.js.map
